<!DOCTYPE html>
<html>
<head>
	<title>Map</title>
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<div id = "container">
	<div id="option-box">
	<h1> Find Your NYC home </h1>
	<div>
		<input type="button" id="show-listing" value="Show Location">
		<input type="button" id="hide-listing" value="Hide Location">
	</div>
	</div>
	</div>
	<div id="map"></div>
    <script>

      var map;

      // creating marker
      var Markers = [];

      function initMap() {
      	// create styles
      	var styles = [
          {
            featureType: 'water',
            stylers: [
              { color: '#A2DBF5'}
            ]
          },{
            featureType: 'administrative',
            elementType: 'labels.text.stroke',
            stylers: [
              { color: '#ffffff' },
              { weight: 6 }
            ]
          },{
            featureType: 'administrative',
            elementType: 'labels.text.fill',
            stylers: [
              { color: '#F35356' }
            ]
          },{
            featureType: 'road.highway',
            elementType: 'geometry.stroke',
            stylers: [
              { color: '#efe9e4' },
              { lightness: -40 }
            ]
          },{
            featureType: 'transit.station',
            stylers: [
              { weight: 20 },
              { hue: '#e85113' }
            ]
          },{
            featureType: 'road.highway',
            elementType: 'labels.icon',
            stylers: [
              { visibility: 'on' }
            ]
          },{
            featureType: 'water',
            elementType: 'labels.text.stroke',
            stylers: [
              { lightness: 200 }
            ]
          },{
            featureType: 'water',
            elementType: 'labels.text.fill',
            stylers: [
              { lightness: -100 }
            ]
          },{
            featureType: 'poi',
            elementType: 'geometry',
            stylers: [
              { visibility: 'on' },
              { color: '#f0e4d3' }
            ]
          },{
            featureType: 'road.highway',
            elementType: 'geometry.fill',
            stylers: [
              { color: '#261A2A' },
              { lightness: -15 }
            ]
          }
        ];
  
      
        // Constructor creates a new map - only center and zoom are required.
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 40.7413549, lng: -73.9980244},
          zoom: 13,
          styles : styles,
          mapTypeControl: false
        });
        
        // These are the real estate listings that will be shown to the user.
        // Normally we'd have these in a database instead.
        var locations = [
          {title: 'Park Ave Penthouse', location: {lat: 40.7713024, lng: -73.9632393}},
          {title: 'Chelsea Loft', location: {lat: 40.7444883, lng: -73.9949465}},
          {title: 'Union Square Open Floor Plan', location: {lat: 40.7347062, lng: -73.9895759}},
          {title: 'East Village Hip Studio', location: {lat: 40.7281777, lng: -73.984377}},
          {title: 'TriBeCa Artsy Bachelor Pad', location: {lat: 40.7195264, lng: -74.0089934}},
          {title: 'Chinatown Homey Space', location: {lat: 40.7180628, lng: -73.9961237}},
          {title: 'EmpireStateBuilding' , location: {lat: 40.7484405, lng: -73.9878531}},
          {title: 'Time Square' , location: {lat: 40.7589545, lng: -73.9893574}}
        ];

        var largeInfowindow = new google.maps.InfoWindow();

        // marker color
        
        //highlighted marker
       
        

        // creating array of markers
        for (var i = 0 ; i < locations.length ; i ++){
        //Get position from location array
        var position = locations[i].location;
        // Get title from location array
        var title = locations[i].title;
        //create marker per location and put it into marker's array
        var marker = new google.maps.Marker({
      		map : map
        	position : position,
        	title : title,
        	animation : google.maps.Animation.DROP,
        	
        	id : i
        	
		});
    
		//Push marker to our marker array
		Markers.push(marker);

		//create onclick event on  individual marker
		marker.addListener("click", function() {
			populateInfoWindow(this, largeInfowindow);
		});

		

	}

	

	document.getElementById('show-listing').addEventListener("click", ShowListing);
	document.getElementById('hide-listing').addEventListener("click", HideListing);

}


	// This function populates the infowindow when the marker is clicked. We'll only allow
    // one infowindow which will open at the marker that is clicked, and populate based
    // on that markers position.

	function populateInfoWindow (marker , infowindow){
		// Check to make sure the infowindow is not already opened on this marker.
        if (infowindow.marker != marker) {
          infowindow.marker = marker;
          infowindow.setContent('<div>' + marker.title + '</div>');
          infowindow.open(map, marker );
          // Make sure the marker property is cleared if the infowindow is closed.
          infowindow.addListener('closeclick',function(){
            infowindow.setMarker = null;
          });
          var streetViewService = new google.maps.StreetViewService();
          var radius = 50;

          // getStreetView by heading(horizontal view),pitch(vertical view)
          	function getstreetView(){
          		if(status == google.maps.StreetViewStatus.OK){
          			var nearStreetViewLocation = data.location.latLng;
              		var heading = google.maps.geometry.spherical.computeHeading(
                		nearStreetViewLocation, marker.position);
                		infowindow.setContent('<div>' + marker.title + '</div><div id="pano"></div>');
                	var panoramaOptions = {
                  		position: nearStreetViewLocation,
                  		pov: {
                    		heading: heading,
                    		pitch: 30

          			}

          		};
          	var panorama = new google.maps.StreetViewPanorama(
                document.getElementById('pano'), panoramaOptions);
            } else {
              infowindow.setContent('<div>' + marker.title + '</div>' +
                '<div>No Street View Found</div>');
            }
          }

          	// streetview
          streetViewService.getPanoramaByLocation(marker.position,radius,getStreetView);
          infowindow.open(map, marker);
        }
      }

      // showlistinh function goes here
      function ShowListing(){
      	var bound = new google.maps.LatLngBounds();
      	for(var i=0 ; i< Markers.length ; i++) {
      		Markers[i].setMap(map);
      		bound.extend(Markers[i].position);

      	}
      	//set boundries of map
		map.fitBounds(bound);


      }


      //hidelisting function goes here
      function HideListing(){
      	for(var i=0 ; i< Markers.length ; i++) {
      		Markers[i].setMap(null);


      }
  }
  	// custom marker
  	

  </script>

 	<!-- adding google-API -->  
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAokV43YDgDadTMFZpi6emos4vlh8fYMtE&v=3&callback=initMap">
    </script>

</body>
</html>